# Story 1.1: Project Setup & Database Schema

**Status:** Approved
**Epic:** Epic 1 - Foundation & Authentication
**Created:** 2026-01-30
**Last Updated:** 2026-01-30 (Approved)

## Story

**As a** developer,
**I want** a properly configured Next.js 15+ fullstack project with MongoDB,
**so that** I can start building features on a solid foundation.

## Acceptance Criteria

1. Given Next.js project setup, When I run `npm install && npm run dev`, Then the application starts successfully
2. Given MongoDB connection, When the app starts, Then database connection is established
3. Given Mongoose schemas, When I run seed script, Then core collections (User, Role, Parish) are created
4. Given ESLint, Prettier, and TypeScript config, When I run lint, Then code style is enforced consistently
5. Given shadcn/ui setup, When I import components, Then they render with Tailwind styling

## Tasks

- [ ] Task 1: Initialize Next.js 15+ project with TypeScript (AC: 1, 4)
  - [ ] Run `npx create-next-app@latest gpbmt-org --typescript --tailwind --eslint --app --src-dir`
  - [ ] Configure TypeScript strict mode in `tsconfig.json`
  - [ ] Setup Prettier with `.prettierrc`
  - [ ] Configure ESLint rules in `.eslintrc.json`
  - [ ] Verify `npm run dev` starts successfully

- [ ] Task 2: Setup shadcn/ui component library (AC: 5)
  - [ ] Run `npx shadcn@latest init`
  - [ ] Install base components: Button, Dialog, Form, Input, Select, Table
  - [ ] Verify components render with Tailwind styling
  - [ ] Create basic layout structure (`src/components/layout/`)

- [ ] Task 3: Configure MongoDB connection with Mongoose (AC: 2)
  - [ ] Install mongoose: `npm install mongoose`
  - [ ] Create connection utility at `src/lib/db/connection.ts`
  - [ ] Setup environment variables in `.env.local`
  - [ ] Add connection test on app startup
  - [ ] Verify database connection logs on `npm run dev`

- [ ] Task 4: Create core Mongoose models (AC: 3)
  - [ ] Create User model at `src/lib/db/models/user.model.ts`
  - [ ] Create Role model at `src/lib/db/models/role.model.ts`
  - [ ] Create Parish model at `src/lib/db/models/parish.model.ts`
  - [ ] Create model index at `src/lib/db/models/index.ts`
  - [ ] Define TypeScript interfaces in `src/types/models.types.ts`

- [ ] Task 5: Create seed script for initial data (AC: 3)
  - [ ] Create seed script at `scripts/seed.ts`
  - [ ] Add 5 predefined roles with permissions
  - [ ] Add sample parish data
  - [ ] Add Super Admin user
  - [ ] Add npm script: `"seed": "npx ts-node scripts/seed.ts"`
  - [ ] Run seed and verify collections created

- [ ] Task 6: Verify all AC met
  - [ ] Run `npm install && npm run dev` - app starts ✓
  - [ ] Check MongoDB connection established ✓
  - [ ] Run `npm run seed` - collections created ✓
  - [ ] Run `npm run lint` - passes ✓
  - [ ] Import shadcn Button - renders correctly ✓

## Dev Notes

### Relevant Files
- `src/lib/db/connection.ts` - MongoDB connection singleton
- `src/lib/db/models/` - Mongoose model definitions
- `src/components/ui/` - shadcn/ui components
- `src/types/` - TypeScript type definitions
- `scripts/seed.ts` - Database seeding script
[Source: docs/architecture.md#source-tree]

### Data Models

**User:**
- _id: ObjectId (PK)
- email: string (unique, required)
- passwordHash: string (required)
- name: string (required)
- role: ObjectId (ref: Role)
- parish: ObjectId (ref: Parish)
- isActive: boolean (default: true)
- mustChangePassword: boolean (default: false)

**Role:**
- _id: ObjectId (PK)
- name: string (enum: SUPER_ADMIN, DIOCESE_MANAGER, PARISH_PRIEST, ACCOUNTANT, PARISH_SECRETARY)
- permissions: string[]

**Parish:**
- _id: ObjectId (PK)
- name: string (required)
- address: string
- phone: string
- email: string
- foundingDate: Date
- isActive: boolean (default: true)

[Source: docs/architecture.md#data-models]

### Tech Stack
| Technology | Version | Purpose |
|------------|---------|---------|
| Next.js | 15.x | Fullstack framework |
| TypeScript | 5.x | Type safety |
| MongoDB | 7.x | Database |
| Mongoose | 8.x | ODM |
| Tailwind CSS | 3.x | Styling |
| shadcn/ui | latest | UI components |

[Source: docs/architecture.md#tech-stack]

### Testing Requirements
- This story focuses on setup; minimal tests required
- Verify connection and model creation manually
- Future stories will add proper test infrastructure

[Source: docs/architecture.md#test-strategy]

### Coding Standards
- **Files:** kebab-case (e.g., `user.model.ts`)
- **Components:** PascalCase (e.g., `Button`)
- **Functions:** camelCase
- **Types/Interfaces:** PascalCase with I prefix (e.g., `IUser`)
- **No `any` type:** Use proper typing
- **Explicit return types** on all functions

[Source: docs/architecture.md#coding-standards]

### Environment Variables
```bash
# .env.local
MONGODB_URI=mongodb+srv://...
NEXTAUTH_SECRET=...
NEXTAUTH_URL=http://localhost:3000
```

[Source: docs/architecture.md#environment-variables]

## Suggested Skills

Based on this story's requirements, consider using:

- **@senior-fullstack** - Full-stack development patterns
  - Use when: Setting up Next.js project structure
  - Benefit: Follow established project scaffolding patterns

- **@test-driven-development** - TDD approach (optional for setup)
  - Use when: Writing seed script validations
  - Benefit: Ensure setup works correctly

To use a skill: `*use-skill {skill-name}`

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-01-30 | 1.0 | Initial draft | @executor |
| 2026-01-30 | 1.1 | Story approved | @user |

## Dev Record

### Agent Model
{To be filled during implementation}

### Completion Notes
{To be filled during implementation}

### File List
**Created:**
{To be filled during implementation}

**Modified:**
{To be filled during implementation}
